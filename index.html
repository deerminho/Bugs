<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>스타일 가이드 뷰어 (B타입)</title>
  <style>
    :root{
      --mint: #3fd6b3; /* 민트색 */
      --black: #0b0b0b;
      --bg: #f7f7f7;
      --btn-size: 64px;
      --gutter: 18px;
    }
    html,body{height:100%;margin:0;font-family: -apple-system, 'Noto Sans KR', 'Roboto', sans-serif;background:var(--bg);color:var(--black)}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px}

    /* 카드 컨테이너 (프레임) */
    .frame{
      width:100%;max-width:980px;height:calc(100vh - 120px);background:#111; /* black outer frame */
      padding:10px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.35);display:flex;flex-direction:column;align-items:center;justify-content:center;}

    /* 안쪽 민트 라인과 내부 백그라운드 */
    .inner{
      width:100%;height:100%;background:#fff;border-radius:8px;padding:12px;box-sizing:border-box;position:relative;overflow:hidden;outline:6px solid var(--mint);}

    /* 이미지 뷰 영역 */
    .viewport{width:100%;height:100%;display:flex;align-items:center;justify-content:center;}
    .slide{max-width:100%;max-height:100%;display:none;object-fit:contain;border-radius:6px}
    .slide.show{display:block}

    /* 좌우 버튼 */
    .nav-btn{position:absolute;top:50%;transform:translateY(-50%);width:var(--btn-size);height:var(--btn-size);border-radius:10px;border:none;background:rgba(255,255,255,0.95);font-size:32px;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,0.25);display:flex;align-items:center;justify-content:center}
    .nav-btn:active{transform:translateY(-50%) scale(0.98)}
    .nav-prev{left:calc(var(--gutter));}
    .nav-next{right:calc(var(--gutter));}

    /* 하단 정보 영역 */
    .bottom-bar{position:absolute;left:0;right:0;bottom:0;padding:12px 18px;display:flex;align-items:center;justify-content:space-between;background:linear-gradient(0deg, rgba(255,255,255,0.95), rgba(255,255,255,0.6));backdrop-filter:blur(2px)}
    .indicator{display:flex;gap:8px;align-items:center}
    .dot{width:12px;height:12px;border-radius:50%;background:rgba(0,0,0,0.15);border:2px solid rgba(0,0,0,0.08)}
    .dot.active{background:var(--mint);box-shadow:0 2px 6px rgba(63,214,179,0.28)}
    .counter{font-weight:600}

    /* 파일 로더 및 안내 */
    .controls{display:flex;gap:10px;align-items:center}
    .file-btn{padding:10px 14px;border-radius:8px;border:2px dashed var(--mint);background:transparent;cursor:pointer;font-weight:700}
    .hint{font-size:14px;color:#222}

    /* 모바일 대응 */
    @media (max-width:640px){
      :root{--btn-size:52px}
      .frame{height:calc(100vh - 60px);border-radius:8px}
      .inner{outline:5px solid var(--mint)}
      .nav-btn{width:48px;height:48px;border-radius:8px;font-size:26px}
      .dot{width:10px;height:10px}
    }

    /* 접근성 포커스 */
    .nav-btn:focus{outline:3px solid rgba(63,214,179,0.25)}
    .file-btn:focus{outline:3px solid rgba(63,214,179,0.25)}

    /* 안내 오버레이 */
    .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.9));padding:30px;box-sizing:border-box}
    .overlay .box{max-width:760px;text-align:left}
    .overlay h2{margin:0 0 8px 0}
    .overlay p{margin:6px 0 0 0;color:#222}
    .sr-only{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="frame" role="region" aria-label="스타일 가이드 뷰어 B타입">
      <div class="inner">
        <div class="viewport" id="viewport">
          <!-- 이미지 엘리먼트가 JS로 삽입됩니다 -->
        </div>

        <button class="nav-btn nav-prev" id="prevBtn" aria-label="이전 페이지" title="이전">
          ◀
        </button>
        <button class="nav-btn nav-next" id="nextBtn" aria-label="다음 페이지" title="다음">
          ▶
        </button>

        <div class="bottom-bar">
          <div class="controls">
            <label class="file-btn" for="fileInput">이미지 불러오기</label>
            <input id="fileInput" class="sr-only" type="file" accept="image/*" multiple />
            <div class="hint">모든 PNG/PPT에서 추출한 이미지 파일을 선택하세요.</div>
          </div>

          <div class="indicator" id="indicator" aria-hidden="false">
            <!-- 점과 카운터가 JS로 채워집니다 -->
            <div class="counter" id="counter">0 / 0</div>
          </div>
        </div>

        <div class="overlay" id="overlay">
          <div class="box">
            <h2>사용 방법</h2>
            <p>1) 오른쪽의 "이미지 불러오기" 버튼을 눌러, ZIP에서 추출한 PNG 파일(또는 단일 이미지 파일들)을 모두 선택하세요.</p>
            <p>2) 파일을 불러온 뒤, 왼쪽/오른쪽 화살표(또는 키보드 ← →)를 눌러 수동으로 페이지를 넘기세요.</p>
            <p>3) GitHub Pages에 올리려면: <strong>이미지 폴더(/images)</strong>에 모든 파일을 넣고, manifest.json을 만들어서 배포하면 됩니다. (아래 안내 참조)</p>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    // B타입 뷰어 스크립트
    const viewport = document.getElementById('viewport');
    const overlay = document.getElementById('overlay');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const fileInput = document.getElementById('fileInput');
    const indicator = document.getElementById('indicator');
    const counter = document.getElementById('counter');

    let images = []; // {name, url}
    let index = 0;

    function renderSlides(){
      viewport.innerHTML = '';
      images.forEach((img, i) => {
        const el = document.createElement('img');
        el.className = 'slide' + (i===index? ' show':'');
        el.src = img.url;
        el.alt = img.name || ('페이지 ' + (i+1));
        viewport.appendChild(el);
      });
      renderIndicator();
    }

    function renderIndicator(){
      // dots
      const existingDots = indicator.querySelectorAll('.dot');
      existingDots.forEach(d => d.remove());
      images.forEach((_, i)=>{
        const d = document.createElement('button');
        d.className = 'dot' + (i===index? ' active':'');
        d.setAttribute('aria-label', '페이지 ' + (i+1));
        d.style.border = 'none';
        d.style.padding = '0';
        d.addEventListener('click', ()=>{ index = i; updateView(); });
        indicator.insertBefore(d, counter);
      });
      counter.textContent = (images.length? (index+1)+' / '+images.length : '0 / 0');
    }

    function updateView(){
      const slides = viewport.querySelectorAll('.slide');
      slides.forEach((s,i)=> s.classList.toggle('show', i===index));
      renderIndicator();
    }

    prevBtn.addEventListener('click', ()=>{ if(images.length===0) return; index = (index-1 + images.length)%images.length; updateView(); });
    nextBtn.addEventListener('click', ()=>{ if(images.length===0) return; index = (index+1)%images.length; updateView(); });

    // 키보드 지원
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'ArrowLeft') prevBtn.click();
      if(e.key === 'ArrowRight') nextBtn.click();
    });

    // 파일 입력 처리 (로컬에서 파일 선택)
    fileInput.addEventListener('change', async (ev)=>{
      const files = Array.from(ev.target.files).filter(f=> f.type.startsWith('image/'));
      if(files.length===0) return;
      // revoke previous object URLs
      images.forEach(it => { if(it.objectUrl) URL.revokeObjectURL(it.objectUrl); });
      images = files.map(f=>({name:f.name, url:URL.createObjectURL(f), objectUrl:true}));
      index = 0;
      renderSlides();
      overlay.style.display = 'none';
    });

    // manifest.json 자동 로드 시도 (GitHub Pages 배포용)
    async function tryLoadManifest(){
      try{
        const res = await fetch('./images/manifest.json', {cache:'no-store'});
        if(!res.ok) return;
        const list = await res.json();
        if(!Array.isArray(list) || list.length===0) return;
        images = list.map(name => ({name, url:'./images/'+name}));
        index = 0;
        renderSlides();
        overlay.style.display = 'none';
      }catch(e){
        // manifest가 없으면 무시
      }
    }

    // 자동 시도
    tryLoadManifest();

    // 접근성: 버튼 포커스 표시
    [prevBtn,nextBtn].forEach(b=>b.addEventListener('keyup', e=>{ if(e.key==='Enter') b.click(); }));

    // 모바일에서 큰 버튼으로 쉽게 조작할 수 있도록 터치 영역 확장
    const touchExpand = (btn)=>{
      btn.addEventListener('touchstart', ()=>{});
    }
    touchExpand(prevBtn); touchExpand(nextBtn);

  </script>
</body>
</html>
